let mousePos,wWidth=innerWidth,wHeight=innerHeight,mouseRadius=100,ballCount=[100,1e3,1500],sizeFraction=innerWidth*innerHeight/1795200,ballcounter=0;const ORIGINAL={wWidth,wHeight,mouseRadius,ballCount:ballCount[1]},mousePostion=document.querySelector(".mouse-position"),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");let cWidth,cHeight;resizeCanvas(),document.body.appendChild(canvas),window.addEventListener("resize",resizeCanvas),canvas.addEventListener("mousemove",updateMouse),canvas.addEventListener("mouseleave",nullishMouse),canvas.addEventListener("touchmove",a=>{const b=a.touches[0];updateMouse({x:b.clientX,y:b.clientY}),a.preventDefault()}),canvas.addEventListener("touchend",nullishMouse);let ballArray=[];for(let a=0;a<ballCount[1];a++)createBall();function createBall(){ballcounter++;let a=10*Math.random()+7,b=Math.random()*(cWidth-2*a)+a,c=Math.random()*(cHeight-2*a)+a,d=[-1,1][Math.floor(2*Math.random())]*(.05*Math.random()),e=[-1,1][Math.floor(2*Math.random())]*(.05*Math.random()),f=`hsl(${360*Math.random()}, ${50*Math.random()+50}%, ${20*Math.random()+40}%)`;const g=new Ball(b,c,d,e,a,[1,.5*Math.random()+1.5],f);ballArray.push(g)}function ballUpdate(){const a=ballCount[1]-ballArray.length;for(let b=0;b<Math.abs(a);b++)0<a?createBall():(ballcounter--,ballArray.splice(Math.floor(Math.random()*ballArray),1))}animate();function animate(){ctx.clearRect(0,0,cWidth,cHeight),ballArray.forEach(a=>a.update(ctx)),requestAnimationFrame(animate)}function updateMouse(a){mousePos={x:a.x,y:a.y}}function nullishMouse(){mousePos=null}function resizeCanvas(){canvas.width=innerWidth,canvas.height=innerHeight;const a=window.devicePixelRatio;canvas.width=innerWidth*a,canvas.height=innerHeight*a,ctx.scale(a,a),sizeFraction=innerWidth*innerHeight/1795200,mouseRadius=ORIGINAL.mouseRadius*Math.pow(sizeFraction,.5),ballCount[1]=Math.ceil(ORIGINAL.ballCount*sizeFraction),ballCount[1]=ballCount[1]<ballCount[2]?ballCount[1]:ballCount[2],ballCount[1]=ballCount[1]>ballCount[0]?ballCount[1]:ballCount[0],cWidth&&(ballUpdate(),ballArray.forEach(a=>{const b=innerWidth/wWidth,c=innerHeight/wHeight;mousePos&&(mousePos.x*=b,mousePos.y*=c),a.x*=b,a.y*=c,a.radiusUpdate(),1>window.devicePixelRatio?(a.vx=a.ORIGINAL.vx/window.devicePixelRatio,a.vy=a.ORIGINAL.vy/window.devicePixelRatio):(a.vx=a.ORIGINAL.vx,a.vy=a.ORIGINAL.vy)}),updateMouseDom()),wWidth=innerWidth,wHeight=innerHeight,cWidth=innerWidth,cHeight=innerHeight}let myEvent;document.addEventListener("mousemove",a=>{updateMouseDom(),myEvent=a}),document.addEventListener("touchmove",a=>{updateMouseDom(),myEvent=a.touches[0]}),setInterval(()=>{updateMouseDom()},2e3),updateMouseDom();function updateMouseDom(){mousePostion.innerHTML=`mousePos: ${myEvent?myEvent.clientX:""} ${myEvent?myEvent.clientX:""}, balls: ${ballcounter}, DPR: ${window.devicePixelRatio}, ww: ${innerWidth}, wh: ${innerHeight}, size fraction: ${sizeFraction.toFixed(4)}`}